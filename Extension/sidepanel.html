<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />

  </head>
  <body>
    <div id="refreshNote" class="refresh-note">
      ⚠️ Refresh the main page if status is not in sync with Bet Button
    </div>
    <div class="status-bet-container">
      <div id="buttonStatus" class="button-status disconnected">
        <span class="status-dot red" title="Not Connected"></span>
        <span class="status-text">Ready</span>
      </div>
      <div id="currentBetAmount" class="current-bet-amount">Next Bet: $0.00</div>
    </div>
    </div>
    <div id="betNotification" class="bet-notification hidden"></div>
    
    <!-- Control Buttons -->
    <div class="control-buttons">
      <button id="startStopBtn" class="btn-small start-btn" disabled style="opacity: 0.5">🎯 Start</button>
      <!-- <button id="resetBetBtn" class="btn-small reset-btn">🔄 Reset</button> -->
      <button id="screenshotBtn" class="btn-small reset-btn">📄 Export Session</button>
    </div>

    <!-- Session Info Combined -->
    <div class="session-combined">
      <div class="session-left">
        <span class="timer-label">⏱️ Session:</span>
        <span id="sessionTimer" class="timer-value">00:00:00</span>
      </div>
      <div class="session-right" id="walletBalance">Balance: $0.00</div>
    </div>
      
      <!-- Super Summary -->
      <div class="super-summary">
        <h4>📈 Full Session Summary</h4>
        <div class="super-stats">
          <span class="super-label">Total Profit: <span id="superProfitCurrency">$</span><span id="superProfit">0.00</span></span>
          <span class="super-label">Total Loss: <span id="superLossCurrency">$</span><span id="superLoss">0.00</span></span>
          <span class="super-label">Max Loss: <span id="maxLossCurrency">$</span><span id="maxLoss">0.00</span></span>
          <span class="super-label">Net: <span id="superNetCurrency">$</span><span id="superNet">0.00</span></span>
          <span class="super-label">Bets: <span id="superBets">0</span></span>
        </div>
      </div>

    <!-- Tab Navigation -->
    <div class="tab-container">
      <button class="tab-btn active" id="settingsTab">⚙️ Settings</button>
      <button class="tab-btn" id="historyTab">📊 History</button>
      <button class="tab-btn" id="helpTab">❓ Help</button>
    </div>

    <!-- Settings Tab Content -->
    <div id="settingsContent" class="tab-content active">
      <!-- Validation Error Message -->
      <div id="validationError" class="validation-error hidden"></div>
      <!-- Configuration -->
      <div class="config-section">
        <h4>💰 Basic Configuration</h4>
        <div class="form-row">
          <div class="form-half">
            <label>Bet Amount</label>
            <input type="number" id="betAmount" step="0.01" min="0.01" max="10000" placeholder="0.00" required />
          </div>
          <div class="form-half">
            <label>Cashout At</label>
            <input type="number" id="cashoutAt" step="0.01" min="1.01" max="1000" placeholder="0.00" required />
          </div>
        </div>
        <div class="form-row">
          <div class="form-half">
            <label>On Loss (%)</label>
            <input type="number" id="onLoss" step="0.01" min="0" max="500" placeholder="50.00" required />
          </div>
          <div class="form-half">
            <label>On Win (%)</label>
            <input type="number" id="onWin" step="0.01" min="-100" max="100" placeholder="25.00" required />
          </div>
        </div>
        
        <h4>🛑 Stop Betting Rules</h4>
        <div class="form-row">
          <div class="form-half">
            <label>Low Crash At</label>
            <input type="number" id="crashAt" step="0.01" min="0" max="10000" placeholder="1.00" required />
          </div>
          <div class="form-half">
            <label>Times</label>
            <input type="number" id="crashTimes" step="1" min="0" max="100" placeholder="3" required />
          </div>
        </div>
        <div class="form-row">
          <div class="form-half">
            <label>High Crash At</label>
            <input type="number" id="highCrashAt" step="0.01" min="0" max="1000" placeholder="0.00" />
          </div>
          <div class="form-half">
            <label>Times</label>
            <input type="number" id="highCrashTimes" step="1" min="0" max="100" placeholder="0" />
          </div>
        </div>
        
        <h4>🔄 Resume Betting Rules</h4>
        <div class="form-row">
          <div class="form-half">
            <label>Resume At</label>
            <input type="number" id="resumeAt" step="0.01" min="1.01" max="100" placeholder="2.00" required />
          </div>
          <div class="form-half">
            <label>Adjust Bet (%)</label>
            <input type="number" id="resumeAdjust" step="0.01" min="-100" max="500" placeholder="0.00" />
          </div>
        </div>
        
        <h4>🔄 Reset Rules</h4>
        <div class="form-row">
          <div class="form-half">
            <label>If Changes (%)</label>
            <input type="number" id="resetThreshold" step="0.01" min="-100" max="1000" placeholder="0.00" />
          </div>
          <div class="form-half">
            <label>If Profit (x times)</label>
            <input type="number" id="profitTimes" step="1" min="0" max="100" placeholder="0" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-full">
            <label>If Loss Amount</label>
            <input type="number" id="lossResetAmount" step="0.01" min="0" max="10000" placeholder="0.00" />
          </div>
        </div>
        
        <h4>🛡️ Wallet Protection</h4>
        <div class="form-row">
          <div class="form-full">
            <label>Stop if Wallet Down (%)</label>
            <input type="number" id="walletStopLoss" step="0.01" min="0" max="100" placeholder="0" />
          </div>
        </div>
        
        <h4>🔢 Display Settings</h4>
        <div class="form-row">
          <div class="form-full">
            <label>Decimal Places (0-5)</label>
            <input type="number" id="decimalPlaces" step="1" min="0" max="5" placeholder="0" value="0" />
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="saveBtn" class="save-btn btn-small">💰 Save Config</button>
      </div>
    </div>

    <!-- History Tab Content -->
    <div id="historyContent" class="tab-content">
           
      <!-- Current Cycle Profit Summary -->
      <div class="profit-summary">
        <h4>📊 Current Cycle</h4>
        <div class="cycle-info">
          <div class="cycle-stat">
            <span class="cycle-label">Time:</span>
            <span id="cycleTimer" class="cycle-value">00:00:00</span>
          </div>
          <div class="cycle-stat">
            <span class="cycle-label">Bets:</span>
            <span id="cycleBets" class="cycle-value">0</span>
          </div>
        </div>
        <div class="profit-stats">
          <span class="profit-label">Profit: <span id="totalProfitCurrency">$</span><span id="totalProfit">0.00</span></span>
          <span class="loss-label">Loss: <span id="totalLossCurrency">$</span><span id="totalLoss">0.00</span></span>
          <span class="net-label">Net: <span id="netProfitCurrency">$</span><span id="netProfit">0.00</span></span>
        </div>
        <div class="graph-container">
          <canvas id="profitChart" width="200" height="100"></canvas>
        </div>
      </div>

      <!-- Betting History -->
      <div class="history-section">
        <div class="history-header">
          <h4>📊 Recent Bets</h4>
          <button id="fullscreenBtn" class="fullscreen-btn">⛶</button>
        </div>
        <div id="historyList" class="history-list">
          <!-- History items will be added here -->
        </div>
      </div>
    </div>

    <!-- Help Tab Content -->
    <div id="helpContent" class="tab-content">
      <div class="help-section">
        <div class="panel-header" data-panel="usage">
          <h4>📚 How to Use</h4>
          <span class="toggle-icon" id="usageToggle">▼</span>
        </div>
        <div class="panel-content" id="usageContent">
          <div class="help-text">
            <p><strong>1. Configure Settings:</strong> Set your betting parameters in the Settings tab</p>
            <p><strong>2. Save Config:</strong> Click "Save Config" to store your settings</p>
            <p><strong>3. Start Betting:</strong> Click "Start" when status shows connected (green dot)</p>
            <p><strong>4. Monitor:</strong> Watch real-time activity in the History tab</p>
          </div>
        </div>
      </div>

      <div class="help-section">
        <div class="panel-header" data-panel="config">
          <h4>⚙️ Configuration Guide</h4>
          <span class="toggle-icon" id="configToggle">▼</span>
        </div>
        <div class="panel-content" id="configContent">
          <div class="help-text">
            <p><strong>Bet Amount:</strong> Initial betting amount</p>
            <p><strong>Cashout At:</strong> Target multiplier to cash out (e.g., 2.5x)</p>
            <p><strong>On Loss (%):</strong> Increase bet by this % after loss (e.g., 30%)</p>
            <p><strong>On Win (%):</strong> Decrease bet by this % after win (e.g., -25%)</p>
          </div>
        </div>
      </div>

      <div class="help-section">
        <div class="panel-header" data-panel="stop">
          <h4>🛑 Stop Betting Rules</h4>
          <span class="toggle-icon collapsed" id="stopToggle">▼</span>
        </div>
        <div class="panel-content collapsed" id="stopContent">
          <div class="help-text">
            <p><strong>Low Crash At:</strong> Crash threshold for "low" crashes (0 = disabled)</p>
            <p><strong>Times:</strong> Skip betting after N consecutive low crash losses</p>
            <p><strong>High Crash At:</strong> Skip after consecutive high crashes (0 = disabled)</p>
            <p><em>Low Example: Skip after 3 losses at crashes ≤ 2.0x</em></p>
            <p><em>High Example: Skip after 2 crashes ≥ 10.0x</em></p>
          </div>
        </div>
      </div>

      <div class="help-section">
        <div class="panel-header" data-panel="resume">
          <h4>🔄 Resume & Reset Rules</h4>
          <span class="toggle-icon collapsed" id="resumeToggle">▼</span>
        </div>
        <div class="panel-content collapsed" id="resumeContent">
          <div class="help-text">
            <p><strong>Resume At:</strong> Resume betting when crash ≥ this value (e.g., 5.0x)</p>
            <p><strong>Adjust Bet (%):</strong> Modify bet amount when resuming (0 = no change)</p>
            <p><strong>Reset Threshold:</strong> Reset to original bet if change exceeds % (0 = disabled)</p>
            <p><strong>Profit Reset:</strong> Reset bet after profit reaches X times original (0 = disabled)</p>
            <p><strong>Loss Reset:</strong> Reset sub session when loss reaches amount (0 = disabled)</p>
          </div>
        </div>
      </div>

      <div class="help-section">
        <div class="panel-header" data-panel="safety">
          <h4>🛡️ Safety Features</h4>
          <span class="toggle-icon collapsed" id="safetyToggle">▼</span>
        </div>
        <div class="panel-content collapsed" id="safetyContent">
          <div class="help-text">
            <p><strong>Wallet Protection:</strong> Stop if wallet drops by % (0 = disabled)</p>
            <p><strong>Auto-refresh:</strong> Page refreshes on connection loss</p>
            <p><strong>Decimal Places:</strong> Number format precision (0-5)</p>
          </div>
        </div>
      </div>

      <div class="help-section">
        <div class="panel-header" data-panel="notes">
          <h4>⚠️ Important Notes</h4>
          <span class="toggle-icon collapsed" id="notesToggle">▼</span>
        </div>
        <div class="panel-content collapsed" id="notesContent">
          <div class="help-text">
            <p><strong>•</strong> Only works on stake.bet crash game page</p>
            <p><strong>•</strong> Green dot = Connected, Red dot = Disconnected</p>
            <p><strong>•</strong> Set values to 0 to disable specific rules</p>
            <p><strong>•</strong> Always test with small amounts first</p>
            <p><strong>•</strong> Gambling involves risk - bet responsibly</p>
          </div>
        </div>
      </div>
    </div>

    <div class="bottom-spacer"></div>
    <script src="sidepanel.js"></script>
  </body>
</html>
